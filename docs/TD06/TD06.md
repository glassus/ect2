# TD06 : Lois de probabilités (et un soupçon de SQL)



{{initexo(0)}}

## 1. Fin du programme de ```SQL``` : création, insertion, modification et suppression

!!! abstract "{{ exercice() }}"
    SQL : travail sur  ```CREATE```  ```INSERT```, ```DELETE``` et ```UPDATE```.

    *Lire en parallèle le cours [2. Création et modification d'une base de données](https://glassus.github.io/ect2/CoursSQL/langage_SQL/#2-creation-et-modification-dune-base-de-donnees){. target="_blank"}*

  
    On souhaite créer une base de données sur des joueurs de rugby.  On va donc créer une table appelée ```joueurs``` qui respectera le schéma relationnel suivant :

     ```joueurs (id:INT, nom:TEXT, taille:INT, poids:INT, club:TEXT)``` 

     La clé primaire de cette table sera l'attribut ```id```.

    !!! note "Question 1"
        Créer la table ```joueurs```.

        {!{ sqlide titre="Votre code SQL :"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            CREATE TABLE joueurs (
            id INTEGER PRIMARY KEY,
            nom TEXT,
            taille INTEGER,
            poids INTEGER,
            club TEXT
            );

            ```

    !!! note "Question 2"
        Insérer les joueurs suivants :

        - Dupont, 174, 84, Toulouse
        - Jalibert, 181, 86, Bordeaux
        - Penaud, 192, 95, Clermont

        {!{ sqlide titre="Votre code SQL"  base="CoursSQL/data/test.db", espace="rugby" }!}

        {!{ sqlide titre="Test de vérification"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            INSERT INTO joueurs
            VALUES
            (1, 'Dupont', 174, 84, 'Toulouse'),
            (2, 'Jalibert', 181, 86, 'Bordeaux'),
            (3, 'Penaud', 192, 95, 'Clermont');
            ```

    !!! note "Question 3"
        Afficher tous les renseignements sur les joueurs pesant moins de 90 kg. 

        {!{ sqlide titre="Votre code SQL"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            SELECT * FROM joueurs
            WHERE poids < 90;
            ```


    !!! note "Question 4"
        Antoine Dupont a pris du poids. Il ne pèse plus 84 kg mais 87 kg. Faire la modification dans la base de données. 

        {!{ sqlide titre="Votre code SQL"  base="CoursSQL/data/test.db", espace="rugby" }!}

        {!{ sqlide titre="Test de vérification"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            UPDATE joueurs
            SET poids = 87
            WHERE nom = 'Dupont';
            ```       

    !!! note "Question 5"
        Damian Penaud décide d'arrêter sa carrière pour devenir dentiste. Supprimer le joueur de la base de données. 

        {!{ sqlide titre="Votre code SQL"  base="CoursSQL/data/test.db", espace="rugby" }!}

        {!{ sqlide titre="Test de vérification"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            DELETE FROM joueurs
            WHERE nom = 'Penaud';
            ```       

    !!! note "Question 6"
        On décide de supprimer totalement cette table de la base de données. Écrire la requête permettant de supprimer la table ```joueurs```.  

        {!{ sqlide titre="Votre code SQL"  base="CoursSQL/data/test.db", espace="rugby" }!}

        {!{ sqlide titre="Test de vérification"  base="CoursSQL/data/test.db", espace="rugby" }!}

        ??? tip "Correction"
            ```SQL
            DROP TABLE joueurs;
            ```     

## 2. Retour au Python : lois de probabilités (uniforme, binomiale, géométrique)

:arrow_right: [Lien pour ouvrir une console Python dans un nouvel onglet](https://console.basthon.fr/){. target="_blank"}


!!! note ":heart: :heart: :heart: Syntaxe des lois usuelles :heart: :heart: :heart:"
    Rappel : on utilise les simulateurs de lois du module ```random``` de la bibliothèque ```numpy```.  
    Ceci nécessite systématiquement la présence des deux lignes suivantes au début de chaque script :
    ```python linenums='1'
    import numpy as np
    import np.random as rd   
    ```  

    - :arrow_right: **loi uniforme** : 
        - ```rd.random()``` renvoie un réel dans $[0;1]$ qui suit une loi uniforme (chaque réel a la même probabilité d'apparition)
        - ```rd.randint(a,b)``` renvoie un entier dans $[a;b[$ qui suit une loi uniforme (chaque entier a la même probabilité d'apparition)

    - :arrow_right: **loi binomiale** : ```rd.binomial(n,p)``` renvoie un entier qui suit une loi binomiale de paramètre $(n,p)$ ($n$ répétitions d'une épreuve de Bernoulli de paramètre $p$)

    - :arrow_right: **loi géométrique** : ```rd.geometric(p)``` renvoie un entier qui suit une loi géométrique de paramètre $p$ (nombre d'expériences de Bernoulli de paramètre $p$ avant l'apparition du premier succès)


!!! abstract "{{ exercice() }}"
    Un gardien est devant une porte fermée : il possède un trousseau de 10 clés dont une seule ouvre la porte. Comme il fait nuit, le gardien essaie les clés au hasard, sans se souvenir quelle clé il vient de tester.

    Soit $X$ la variable aléatoire qui compte le nombre d’essais jusqu’à ce que la porte s’ouvre.

    1. Que vaut $E(X)$ ?
    2. Écrire un code qui simule 100000 ouvertures de porte et retrouver la valeur théorique de $E(X)$.

    ??? tip "Correction"
        1. $E(X) = \frac{1}{0.1} = 10$
        2. 
        ```python linenums='1'
        import numpy as np
        import numpy.random as rd

        n = 10**5

        s = 0

        for k in range(n):
            s += rd.geometric(0.1)

        print(s/n)
        ```   


!!! abstract "{{ exercice() }}"
    *d'après ECT2 Mathématiques-Informatique, éditions Ellipses.*

    Un opérateur d'un centre d'appel doit joindre 100 clients par téléphone. La probabilité qu'il joigne un client donné est $\dfrac{1}{8}$.
    
    Le matin, il lance une première série de 100 appels.  
    L'après-midi, il relance une série d'appels, uniquement vers les clients qu'il n'a pas réussi à joindre le matin.

    Compléter le script ci-dessous, pour qu'il simule cette expérience et affiche le nombre de clients que le vendeur a réussi à contacter à la fin de la journée.

    ```python linenums='1'
    import numpy as np
    import np.random as rd

    # à vous



    ```

    ??? tip "Correction"
        ```python linenums='1'
        import numpy as np
        import numpy.random as rd

        nb_matin = rd.binomial(100, 1/8)

        nb_aprem = rd.binomial(100-nb_matin, 1/8)

        total = nb_matin + nb_aprem

        print(total)
        ```


!!! abstract "{{ exercice() }}"
    *d'après BCE ESC 2020*

    Un mobile se déplace sur les points à coordonnées entières positives d'un axe d'origine $O$.  
    Au départ, le mobile est à l'origine (point d'abscisse 0). Le mobile se déplace selon la règle suivante : s'il est sur le point d'abscisse $k-1$ ($k \in \mathbb{N}^*$) à l'instant $n$ ($n \in \mathbb{N}$), alors, à l'instant $n+1$, il sera sur le point d'abscisse $k$ avec la probabilité $\frac{k}{k+1}$, ou sur le point d'abscisse 0 avec la probabilité $\frac{1}{k+1}$.


    On note $U$ l'instant auquel le mobile se trouve pour la première fois à l'origine (sans compter son positionnement de départ) et on admet que $U$ est une variable aléatoire. On convient que $U$ prend la valeur 0 si le mobile ne revient jamais en $O$.

    Compléter les commandes du script Python suivant afin qu'il calcule et affiche la valeur prise par $U$ lors de l'expérience aléatoire étudiée.

    ```python linenums='1'
    import numpy as np
    import numpy.random as rd

    k = 1
    hasard = rd.randint(1, k+2)
    while hasard < ...:
        k = k + 1
        hasard = ...

    print('U a pris la valeur', ...)
    ```

    ??? tip "Correction"
        ```python linenums='1'
        import numpy as np
        import numpy.random as rd

        k = 1
        hasard = rd.randint(1, k+2)
        while hasard < k+1:
            k = k + 1
            hasard = rd.randint(1, k+2)

        print('U a pris la valeur', k)
        ```


!!! abstract "{{ exercice() }}"
    *d'après BCE ESC 2020*

    On effectue une succession de lancers (supposés indépendants) d'une pièce de monnaie équilibrée pour laquelle la probabilité d'obtenir «pile» vaut $\frac{1}{2}$ et celle d'obtenir «face» vaut aussi $\frac{1}{2}$.

    On considère aussi la variable aléatoire $X$, égale au rang d'apparition d'un premier «pile», et la variable aléatoire $Y$, égale au rang d'apparition du premier «face».

    On décide de coder «pile» par 1 et «face» par 0.

    Compléter le script Python suivant afin qu'il permette le calcul et l'affichage des valeurs prises par les variables aléatoires $X$ et $Y$ lors de l'expérience réalisée dans cet exercice.

    ```python linenums='1'
    import numpy as np
    import numpy.random as rd

    x = ...
    y = ...
    lancer = rd.randint(0,2)
    if lancer == 1:
        while lancer == 1:
            lancer = rd.randint(0,2)
            y = ...
    else:
        while lancer == 0:
            lancer = rd.randint(0,2)
            x = ...

    print(x)
    print(y)
    ```

    ??? tip "Correction"
        ```python linenums='1'
        import numpy as np
        import numpy.random as rd

        x = 1
        y = 1
        lancer = rd.randint(0,2)
        if lancer == 1:
            while lancer == 1:
                lancer = rd.randint(0,2)
                y = y + 1
        else:
            while lancer == 0:
                lancer = rd.randint(0,2)
                x = x + 1

        print(x)
        print(y)
        ```



